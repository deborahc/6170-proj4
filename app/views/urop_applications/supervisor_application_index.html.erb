<%= link_to 'New UROP Posting', new_posting_path, :style=>"margin:20px;" %><br>
<%= link_to 'View all Postings', postings_path, :style=>"margin:20px" %>

<center><h3><%=current_user.first_name+" "+current_user.last_name%>'s UROP postings</h3></center>

<% current_user.postings.each do |posting| %>
  <div class="row-fluid">
  <div class="span1"></div>
  <div class="span8">
      <h4> <%= link_to posting.title, posting_path(posting.id) %></h4>
      <p>Sponsor: <%= posting.supervisor.first_name %> <%= posting.supervisor.last_name %></p>
      <p>Project description: <%= posting.description %></p>
      <p>Skills: <%= posting.skills %></p>
      <p>Funding type: <%= posting.funding_type %></p>

      <!-- Only give users the option to see delete button for postings that they created, validated by can_delete anyway-->
      <% if posting.supervisor_id == current_user.id %>
        <%=link_to( 'Remove Post', posting, method: :delete, :class => 'btn btn-med btn-primary', data: { confirm: 'Are you sure?' } )%>
        <%= link_to('Edit', edit_posting_path(posting), :class => 'btn btn-med btn-primary', :method => :get) %>
      <% end %>
      <br>
      <%= link_to "View Applications", supervisor_application_show_path(posting), class: "btn btn-med", :method=>:get %>
  	<h4> Applications for <%=posting.title%></h4>
  	<% if posting.urop_applications.empty? %>
  		<p> No applications </p>
  	<% end %>
    <% posting.urop_applications.each do |application| %>
      Student: &nbsp<%= link_to application.student.first_name+" "+application.student.last_name, student_path(application.student.id) %><br>
      Contact info: <%= application.student.email %><br>
      Year: <%= application.student.year %><br>
      <%= application.message %><br>
      <button class="btn btn-success btn-sm" data-toggle="modal" data-target="#reply-modal<%=application.id%>">
        Send an Email
      </button>
      <%= render "email/form", :application => application %>
    <% end %>
  </div><!--span-->
</div> <!-- row fluid -->
<% end %>